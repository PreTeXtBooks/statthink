<?xml version="1.0" encoding="UTF-8" ?>

<chapter xml:id="ch-normal" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>The Normal Random Variable</title>

  <section xml:id="sec-student-learning-objectives-6">
    <title>Student Learning Objectives</title>
    <p>
      This chapter introduces a very important bell-shaped distribution known as the Normal distribution. Computations associated with this distribution are discussed, including the percentiles of the distribution and the identification of intervals of subscribed probability. The Normal distribution may serve as an approximation to other distributions. We demonstrate this property by showing that under appropriate conditions the Binomial distribution can be approximated by the Normal distribution. This property of the Normal distribution will be picked up in the next chapter where the mathematical theory that establishes the Normal approximation is demonstrated. By the end of this chapter, the student should be able to:
    </p>
    <ul>
      <li><p>Recognize the Normal density and apply <c>R</c> functions for computing Normal probabilities and percentiles.</p></li>
      <li><p>Associate the distribution of a Normal random variable with that of its standardized counterpart, which is obtained by centering and re-scaling.</p></li>
      <li><p>Use the Normal distribution to approximate the Binomial distribution.</p></li>
    </ul>
  </section>

  <section xml:id="sec-continuous-distribution">
    <title>The Normal Random Variable</title>
    
    <p>
      The Normal distribution is the most important of all distributions that are used in statistics. In many cases it serves as a generic model for the distribution of a measurement. Moreover, even in cases where the measurement is modeled by other distributions (i.e. Binomial, Poisson, Uniform, Exponential, etc.) the Normal distribution emerges as an approximation of the distribution of numerical characteristics of the data produced by such measurements.
    </p>

    <subsection xml:id="subsec-normal-distribution">
      <title>The Normal Distribution</title>
      
      <p>
        A Normal random variable has a continuous distribution over the sample space of all numbers, negative or positive. We denote the Normal distribution via <q><m>X \sim \mathrm{Normal}(\mu, \sigma^2)</m></q>, where <m>\mu = \mathbb{E}(X)</m> is the expectation of the random variable and <m>\sigma^2 = \mathrm{Var}(X)</m> is its variance<fn>If <m>X \sim \mathrm{Normal}(\mu,\sigma^2)</m> then the density of <m>X</m> is given by the formula <m>f(x) = \exp\{-\frac{(x-\mu)^2}{2 \sigma^2}\}/\sqrt{2 \pi \sigma^2}</m>, for all <m>x</m>.</fn>.
      </p>
      
      <p>
        Consider, for example, <m>X \sim \mathrm{Normal}(2,9)</m>. The density of the distribution is presented in <xref ref="fig-normal1" />. Observe that the distribution is symmetric about the expectation 2. The random variable is more likely to obtain its value in the vicinity of the expectation. Values much larger or much smaller than the expectation are substantially less likely.
      </p>

      <figure xml:id="fig-normal1">
        <caption>The Normal(2,9) Distribution</caption>
        <image source="_figures/Normal1.png" width="60%">
          <description>A plot showing the Normal(2,9) distribution with the region between 0 and 5 shaded, indicating P(0 &lt; X &lt; 5)</description>
        </image>
      </figure>

      <p>
        The density of the Normal distribution can be computed with the aid of the function <c>dnorm</c>. The cumulative probability can be computed with the function <c>pnorm</c>. For illustrating the use of the latter function, assume that <m>X \sim \mathrm{Normal}(2,9)</m>. Say one is interested in the computation of the probability <m>P(0 &lt; X \leq 5)</m> that the random variable obtains a value that belongs to the interval <m>(0,5]</m>. The required probability is indicated by the marked area in <xref ref="fig-normal1" />. This area can be computed as the difference between the probability <m>P(X \leq 5)</m>, the area to the left of 5, and the probability <m>P(X \leq 0)</m>, the area to the left of 0:
      </p>

      <program language="r">
        <input>
pnorm(5,2,3) - pnorm(0,2,3)
        </input>
      </program>

      <p>
        The difference is the indicated area that corresponds to the probability of being inside the interval, which turns out to be approximately equal to 0.589. Notice that the expectation <m>\mu</m> of the Normal distribution is entered as the second argument to the function. The third argument to the function is the standard deviation, i.e. the square root of the variance. In this example, the standard deviation is <m>\sqrt{9}=3</m>.
      </p>

      <p>
        <xref ref="fig-normal2" /> displays the densities of the Normal distribution for the combinations <m>\mu= 0</m>, <m>\sigma^2 = 1</m> (the red line); <m>\mu = 2</m>, <m>\sigma^2 = 9</m> (the black line); and <m>\mu = -3</m>, <m>\sigma^2 = 1/4</m> (the green line). Observe that the smaller the variance the more concentrated is the distribution of the random variable about the expectation.
      </p>

      <figure xml:id="fig-normal2">
        <caption>The Normal Distribution for Various Values of <m>\mu</m> and <m>\sigma^2</m></caption>
        <image source="_figures/Normal2.png" width="60%">
          <description>A plot showing three Normal distributions with different parameters: N(0,1) in red, N(2,9) in black, and N(-3,0.25) in green</description>
        </image>
      </figure>

      <example xml:id="ex-normal-iq">
        <statement>
          <p>
            IQ tests are a popular (and controversial) mean for measuring intelligence. They are produced as (weighted) average of a response to a long list of questions, designed to test different abilities. The score of the test across the entire population is set to be equal to 100 and the standard deviation is set to 15. The distribution of the score is Normal. Hence, if <m>X</m> is the IQ score of a random subject then <m>X \sim \mathrm{Normal}(100,15^2)</m>.
          </p>
        </statement>
      </example>

      <example xml:id="ex-normal-height">
        <statement>
          <p>
            Any measurement that is produced as a result of the combination of many independent influencing factors is likely to possess the Normal distribution. For example, the height of a person is influenced both by genetics and by the environment in which that person grew up. Both the genetic and the environmental influences are a combination of many factors. Thereby, it should not come as a surprise that the heights of people in a population tend to follow the Normal distribution.
          </p>
        </statement>
      </example>
    </subsection>

    <subsection xml:id="subsec-standard-normal-distribution">
      <title>The Standard Normal Distribution</title>
      
      <p>
        The standard normal distribution is a normal distribution of standardized values, which are called <m>z</m>-scores. A <m>z</m>-score is the original measurement measured in units of the standard deviation from the expectation. For example, if the expectation of a Normal distribution is 2 and the standard deviation is <m>3 = \sqrt{9}</m>, then the value of 0 is 2/3 standard deviations smaller than (or to the left of) the expectation. Hence, the <m>z</m>-score of the value 0 is -2/3. The calculation of the <m>z</m>-score emerges from the equation:
      </p>

      <me>(0 =)\; x = \mu + z \cdot \sigma\; (= 2 + z \cdot 3)</me>

      <p>
        The <m>z</m>-score is obtained by solving the equation
      </p>

      <me>0 = 2 + z \cdot 3 \quad \Longrightarrow \quad z = (0-2)/3 = -2/3\;.</me>

      <p>
        In a similar way, the <m>z</m>-score of the value <m>x = 5</m> is equal to 1, following the solution of the equation <m>5 = 2 + z\cdot 3</m>, which leads to <m>z = (5-2)/3 = 1</m>.
      </p>

      <p>
        The standard Normal distribution is the distribution of a standardized Normal measurement. The expectation for the standard Normal distribution is 0 and the variance is 1. When <m>X \sim N(\mu,\sigma^2)</m> has a Normal distribution with expectation <m>\mu</m> and variance <m>\sigma^2</m> then the transformed random variable <m>Z = (X-\mu)/\sigma</m> produces the standard Normal distribution <m>Z\sim N(0,1)</m>. The transformation corresponds to the reexpression of the original measurement in terms of a new <q>zero</q> and a new unit of measurement. The new <q>zero</q> is the expectation of the original measurement and the new unit is the standard deviation of the original measurement.
      </p>

      <p>
        Computation of probabilities associated with a Normal random variable <m>X</m> can be carried out with the aid of the standard Normal distribution. For example, consider the computation of the probability <m>P(0 &lt; X \leq 5)</m> for <m>X \sim N(2, 9)</m>, that has expectation <m>\mu=2</m> and standard deviation <m>\sigma = 3</m>. Consider <m>X</m>'s standardized values: <m>Z = (X-2)/3</m>. The boundaries of the interval <m>[0,5]</m>, namely <m>0</m> and <m>5</m>, have standardized <m>z</m>-scores of <m>(0-2)/3=-2/3</m> and <m>(5-2)/3 =1</m>, respectively. Clearly, the original measurement <m>X</m> falls between the original boundaries (<m>0 &lt; X \leq 5</m>) if, and only if, the standardized measurement <m>Z</m> falls between the standardized boundaries (<m>-2/3 &lt; Z \leq 1</m>). Therefore, the probability that <m>X</m> obtains a value in the range <m>[0,5]</m> is equal to the probability that <m>Z</m> obtains a value in the range <m>[-2/3,1]</m>.
      </p>

      <figure xml:id="fig-normal3">
        <caption>The Standard Normal Distribution</caption>
        <image source="_figures/Normal3.png" width="60%">
          <description>A plot showing the standard Normal distribution with the region between -2/3 and 1 shaded</description>
        </image>
      </figure>

      <p>
        The function <c>pnorm</c> was used in the previous subsection in order to compute that probability that <m>X</m> obtains values between 0 and 5. The computation produced the probability 0.5888522. We can repeat the computation by the application of the same function to the standardized values:
      </p>

      <program language="r">
        <input>
pnorm((5-2)/3) - pnorm((0-2)/3)
        </input>
      </program>

      <p>
        The value that is being computed, the area under the graph for the standard Normal distribution, is presented in <xref ref="fig-normal3" />. Recall that 3 arguments were specified in the previous application of the function <c>pnorm</c>: the <m>x</m> value, the expectation, and the standard deviation. In the given application we did not specify the last two arguments, only the first one. (Notice that the output of the expression <c>(5-2)/3</c> is a single number and, likewise, the output of the expression <c>(0-2)/3</c> is also a single number.)
      </p>

      <p>
        Most <c>R</c> functions have many arguments that enable flexible application in a wide range of settings. For convenience, however, default values are set to most of these arguments. These default values are used unless an alternative value for the argument is set when the function is called. The default value of the second argument of the function <c>pnorm</c> that specifies the expectation is <c>mean=0</c>, and the default value of the third argument that specifies the standard deviation is <c>sd=1</c>. Therefore, if no other value is set for these arguments the function computes the cumulative distribution function of the standard Normal distribution.
      </p>
    </subsection>

    <subsection xml:id="subsec-computing-percentiles">
      <title>Computing Percentiles</title>
      
      <p>
        Consider the issue of determining the range that contains 95% of the probability for a Normal random variable. We start with the standard Normal distribution. Consult <xref ref="fig-normal4" />. The figure displays the standard Normal distribution with the central region shaded. The area of the shaded region is 0.95.
      </p>

      <p>
        We may find the <m>z</m>-values of the boundaries of the region, denoted in the figure as <m>z_0</m> and <m>z_1</m> by the investigation of the cumulative distribution function. Indeed, in order to have 95% of the distribution in the central region one should leave out 2.5% of the distribution in each of the two tails. That is, 0.025 should be the area of the unshaded region to the right of <m>z_1</m> and, likewise, 0.025 should be the area of the unshaded region to the left of <m>z_0</m>. In other words, the cumulative probability up to <m>z_0</m> should be 0.025 and the cumulative distribution up to <m>z_1</m> should be 0.975.
      </p>

      <p>
        In general, given a random variable <m>X</m> and given a percent <m>p</m>, the <m>x</m> value with the property that the cumulative distribution up to <m>x</m> is equal to the probability <m>p</m> is called the <m>p</m>-<em>percentile</em> of the distribution. Here we seek the 2.5%-percentile and the 97.5%-percentile of the standard Normal distribution.
      </p>

      <figure xml:id="fig-normal4">
        <caption>Central 95% of the Standard Normal Distribution</caption>
        <image source="_figures/Normal4.png" width="60%">
          <description>A plot showing the standard Normal distribution with the central 95% region shaded, bounded by z_0 = -1.96 and z_1 = 1.96</description>
        </image>
      </figure>

      <p>
        The percentiles of the Normal distribution are computed by the function <c>qnorm</c>. The first argument to the function is a probability (or a sequence of probabilities), the second and third arguments are the expectation and the standard deviations of the normal distribution. The default values to these arguments are set to 0 and 1, respectively. Hence if these arguments are not provided the function computes the percentiles of the standard Normal distribution. Let us apply the function in order to compute <m>z_1</m> and <m>z_0</m>:
      </p>

      <program language="r">
        <input>
qnorm(0.975)
qnorm(0.025)
        </input>
      </program>

      <p>
        Observe that <m>z_1</m> is practically equal to 1.96 and <m>z_0 = -1.96 = -z_1</m>. The fact that <m>z_0</m> is the negative of <m>z_1</m> results from the symmetry of the standard Normal distribution about 0. As a conclusion we get that for the standard Normal distribution 95% of the probability is concentrated in the range <m>[-1.96, 1.96]</m>.
      </p>

      <figure xml:id="fig-normal5">
        <caption>Central 95% of the Normal(2,9) Distribution</caption>
        <image source="_figures/Normal5.png" width="60%">
          <description>A plot showing the Normal(2,9) distribution with the central 95% region shaded</description>
        </image>
      </figure>

      <p>
        The problem of determining the central range that contains 95% of the distribution can be addressed in the context of the original measurement <m>X</m> (See <xref ref="fig-normal5" />). We seek in this case an interval centered at the expectation 2, which is the center of the distribution of <m>X</m>, unlike 0 which was the center of the standardized values <m>Z</m>. One way of solving the problem is via the application of the function <c>qnorm</c> with the appropriate values for the expectation and the standard deviation:
      </p>

      <program language="r">
        <input>
qnorm(0.975,2,3)
qnorm(0.025,2,3)
        </input>
      </program>

      <p>
        Hence, we get that <m>x_0 = -3.88</m> has the property that the total probability to its left is 0.025 and <m>x_1 = 7.88</m> has the property that the total probability to its right is 0.025. The total probability in the range <m>[-3.88, 7.88]</m> is 0.95.
      </p>

      <p>
        An alternative approach for obtaining the given interval exploits the interval that was obtained for the standardized values. An interval <m>[-1.96,1.96]</m> of standardized <m>z</m>-values corresponds to an interval <m>[2 - 1.96 \cdot 3, 2 + 1.96\cdot 3]</m> of the original <m>x</m>-values:
      </p>

      <program language="r">
        <input>
2 + qnorm(0.975)*3
2 + qnorm(0.025)*3
        </input>
      </program>

      <p>
        Hence, we again produce the interval <m>[-3.88,7.88]</m>, the interval that was obtained before as the central interval that contains 95% of the distribution of the <m>\mathrm{Normal}(2,9)</m> random variable.
      </p>

      <p>
        In general, if <m>X \sim N(\mu,\sigma^2)</m> is a Normal random variable then the interval <m>[\mu - 1.96 \cdot \sigma, \mu + 1.96 \cdot \sigma]</m> contains 95% of the distribution of the random variable. Frequently one uses the notation <m>\mu \pm 1.96 \cdot \sigma</m> to describe such an interval.
      </p>
    </subsection>

    <subsection xml:id="subsec-outliers-normal">
      <title>Outliers and the Normal Distribution</title>
      
      <p>
        Consider, next, the computation of the interquartile range in the Normal distribution. Recall that the interquartile range is the length of the central interval that contains 50% of the distribution. This interval starts at the first quartile (Q1), the value that splits the distribution so that 25% of the distribution is to the left of the value and 75% is to the right of it. The interval ends at the third quartile (Q3) where 75% of the distribution is to the left and 25% is to the right.
      </p>

      <p>
        For the standard Normal the third and first quartiles can be computed with the aid of the function <c>qnorm</c>:
      </p>

      <program language="r">
        <input>
qnorm(0.75)
qnorm(0.25)
        </input>
      </program>

      <p>
        Observe that for the standard Normal distribution one has that 75% of the distribution is to the left of the value 0.6744898, which is the third quartile of this distribution. Likewise, 25% of the standard Normal distribution are to the left of the value -0.6744898, which is the first quartile. The interquartile range is the length of the interval between the third and the first quartiles. In the case of the standard Normal distribution this length is equal to <m>0.6744898 - (-0.6744898) = 1.348980</m>.
      </p>

      <p>
        In Chapter 3 we considered box plots as a mean for the graphical display of numerical data. The box plot includes a vertical rectangle that initiates at the first quartile and ends at the third quartile, with the median marked within the box. The rectangle contains 50% of the data. Whiskers extend from the ends of this rectangle to the smallest and to the largest data values that are not outliers. Outliers are values that lie outside of the normal range of the data. Outliers are identified as values that are more than 1.5 times the interquartile range away from the ends of the central rectangle. Hence, a value is an outlier if it is larger than the third quartile plus 1.5 times the interquartile range or if it is less than the first quartile minus 1.5 times the interquartile range.
      </p>

      <p>
        How likely is it to obtain an outlier value when the measurement has the standard Normal distribution? We obtained that the third quartile of the standard Normal distribution is equal to 0.6744898 and the first quartile is minus this value. The interquartile range is the difference between the third and first quartiles. The upper and lower thresholds for the defining outliers are:
      </p>

      <program language="r">
        <input>
qnorm(0.75) + 1.5*(qnorm(0.75)-qnorm(0.25))
qnorm(0.25) - 1.5*(qnorm(0.75)-qnorm(0.25))
        </input>
      </program>

      <p>
        Hence, a value larger than 2.697959 or smaller than -2.697959 would be identified as an outlier.
      </p>

      <p>
        The probability of being less than the upper threshold 2.697959 in the standard Normal distribution is computed with the expression <c>pnorm(2.697959)</c>. The probability of being above the threshold is 1 minus that probability, which is the outcome of the expression <c>1-pnorm(2.697959)</c>.
      </p>

      <p>
        By the symmetry of the standard Normal distribution we get that the probability of being below the lower threshold -2.697959 is equal to the probability of being above the upper threshold. Consequently, the probability of obtaining an outlier is equal to twice the probability of being above the upper threshold:
      </p>

      <program language="r">
        <input>
2*(1-pnorm(2.697959))
        </input>
      </program>

      <p>
        We get that for the standard Normal distribution the probability of an outlier is approximately 0.7%.
      </p>
    </subsection>
  </section>

  <section xml:id="sec-normal-approximation">
    <title>Approximation of the Binomial Distribution</title>
    
    <p>
      The Normal distribution emerges frequently as an approximation of the distribution of data characteristics. The probability theory that mathematically establishes such approximation is called the Central Limit Theorem and is the subject of the next chapter. In this section we demonstrate the Normal approximation in the context of the Binomial distribution.
    </p>

    <subsection xml:id="subsec-approximate-binomial">
      <title>Approximate Binomial Probabilities and Percentiles</title>
      
      <p>
        Consider, for example, the probability of obtaining between 1940 and 2060 heads when tossing 4,000 fair coins. Let <m>X</m> be the total number of heads. The tossing of a coin is a trial with two possible outcomes: <q>Head</q> and <q>Tail</q>. The probability of a <q>Head</q> is 0.5 and there are 4,000 trials. Let us call obtaining a <q>Head</q> in a trial a <q>Success</q>. Observe that the random variable <m>X</m> counts the total number of successes. Hence, <m>X \sim \mathrm{Binomial}(4000,0.5)</m>.
      </p>

      <p>
        The probability <m>P(1940 \leq X \leq 2060)</m> can be computed as the difference between the probability <m>P(X \leq 2060)</m> of being less or equal to 2060 and the probability <m>P(X &lt; 1940)</m> of being strictly less than 1940. However, 1939 is the largest integer that is still strictly less than the integer 1940. As a result we get that <m>P(X &lt; 1940) = P(X \leq 1939)</m>. Consequently, <m>P(1940 \leq X \leq 2060) = P(X \leq 2060) - P(X \leq 1939)</m>.
      </p>

      <p>
        Applying the function <c>pbinom</c> for the computation of the Binomial cumulative probability, namely the probability of being less or equal to a given value, we get that the probability in the range between 1940 and 2060 is equal to
      </p>

      <program language="r">
        <input>
pbinom(2060,4000,0.5) - pbinom(1939,4000,0.5)
        </input>
      </program>

      <p>
        This is an exact computation. The Normal approximation produces an approximate evaluation, not an exact computation. The Normal approximation replaces Binomial computations by computations carried out for the Normal distribution. The computation of a probability for a Binomial random variable is replaced by computation of probability for a Normal random variable that has the same expectation and standard deviation as the Binomial random variable.
      </p>

      <p>
        Notice that if <m>X \sim \mathrm{Binomial}(4000,0.5)</m> then the expectation is <m>\mathbb{E}(X) = 4,000 \times 0.5 = 2,000</m> and the variance is <m>\mathrm{Var}(X) = 4,000 \times 0.5 \times 0.5 = 1,000</m>, with the standard deviation being the square root of the variance. Repeating the same computation that we conducted for the Binomial random variable, but this time with the function <c>pnorm</c> that is used for the computation of the Normal cumulative probability, we get:
      </p>

      <program language="r">
        <input>
mu &lt;- 4000*0.5
sig &lt;- sqrt(4000*0.5*0.5)
pnorm(2060,mu,sig) - pnorm(1939,mu,sig)
        </input>
      </program>

      <p>
        Observe that in this example the Normal approximation of the probability (0.9442441) agrees with the Binomial computation of the probability (0.9442883) up to 3 significant digits.
      </p>

      <p>
        Normal computations may also be applied in order to find approximate percentiles of the Binomial distribution. For example, let us identify the central region that contains for a <m>\mathrm{Binomial}(4000,0.5)</m> random variable (approximately) 95% of the distribution. Towards that end we can identify the boundaries of the region for the Normal distribution with the same expectation and standard deviation as that of the target Binomial distribution:
      </p>

      <program language="r">
        <input>
qnorm(0.975,mu,sig)
qnorm(0.025,mu,sig)
        </input>
      </program>

      <p>
        After rounding to the nearest integer we get the interval <m>[1938,2062]</m> as a proposed central region.
      </p>

      <p>
        In order to validate the proposed region we may repeat the computation under the actual Binomial distribution:
      </p>

      <program language="r">
        <input>
qbinom(0.975,4000,0.5)
qbinom(0.025,4000,0.5)
        </input>
      </program>

      <p>
        Again, we get the interval <m>[1938,2062]</m> as the central region, in agreement with the one proposed by the Normal approximation. Notice that the function <c>qbinom</c> produces the percentiles of the Binomial distribution. It may not come as a surprise to learn that <c>qpois</c>, <c>qunif</c>, <c>qexp</c> compute the percentiles of the Poisson, Uniform and Exponential distributions, respectively.
      </p>

      <p>
        The ability to approximate one distribution by the other, when computation tools for both distributions are handy, seems to be of questionable importance. Indeed, the significance of the Normal approximation is not so much in its ability to approximate the Binomial distribution as such. Rather, the important point is that the Normal distribution may serve as an approximation to a wide class of distributions, with the Binomial distribution being only one example. Computations that are based on the Normal approximation will be valid for all members in the class of distributions, including cases where we don't have the computational tools at our disposal or even in cases where we do not know what the exact distribution of the member is! As promised, a more detailed discussion of the Normal approximation in a wider context will be presented in the next chapter.
      </p>

      <p>
        On the other hand, one need not assume that any distribution is well approximated by the Normal distribution. For example, the distribution of wealth in the population tends to be skewed, with more than 50% of the people possessing less than 50% of the wealth and small percentage of the people possessing the majority of the wealth. The Normal distribution is not a good model for such distribution. The Exponential distribution, or distributions similar to it, may be more appropriate.
      </p>
    </subsection>

    <subsection xml:id="subsec-continuity-corrections">
      <title>Continuity Corrections</title>
      
      <p>
        In order to complete this section let us look more carefully at the Normal approximations of the Binomial distribution.
      </p>

      <figure xml:id="fig-normal6">
        <caption>Normal Approximation of the Binomial Distribution</caption>
        <image source="_figures/Normal6.png" width="60%">
          <description>A plot showing a Binomial distribution as bars with a Normal curve superimposed, demonstrating the continuity correction concept</description>
        </image>
      </figure>

      <p>
        In principle, the Normal approximation is valid when <m>n</m>, the number of independent trials in the Binomial distribution, is large. When <m>n</m> is relatively small the approximation may not be so good. Indeed, take <m>X \sim \mathrm{Binomial}(30,0.3)</m> and consider the probability <m>P(X \leq 6)</m>. Compare the actual probability to the Normal approximation:
      </p>

      <program language="r">
        <input>
pbinom(6,30,0.3)
pnorm(6,30*0.3,sqrt(30*0.3*0.7))
        </input>
      </program>

      <p>
        The Normal approximation, which is equal to 0.1159989, is not too close to the actual probability, which is equal to 0.1595230.
      </p>

      <p>
        A naïve application of the Normal approximation for the <m>\mathrm{Binomial}(n,p)</m> distribution may not be so good when the number of trials <m>n</m> is small. Yet, a small modification of the approximation may produce much better results. In order to explain the modification consult <xref ref="fig-normal6" /> where you will find the bar plot of the Binomial distribution with the density of the approximating Normal distribution superimposed on top of it. The target probability is the sum of heights of the bars that are painted in red. In the naïve application of the Normal approximation we used the area under the normal density which is to the left of the bar associated with the value <m>x=6</m>.
      </p>

      <p>
        Alternatively, you may associate with each bar located at <m>x</m> the area under the normal density over the interval <m>[x-0.5, x+0.5]</m>. The resulting correction to the approximation will use the Normal probability of the event <m>\{X \leq 6.5\}</m>, which is the area shaded in red. The application of this approximation, which is called <em>continuity correction</em> produces:
      </p>

      <program language="r">
        <input>
pnorm(6.5,30*0.3,sqrt(30*0.3*0.7))
        </input>
      </program>

      <p>
        Observe that the corrected approximation is much closer to the target probability, which is 0.1595230, and is substantially better that the uncorrected approximation which was 0.1159989. Generally, it is recommended to apply the continuity correction to the Normal approximation of a discrete distribution.
      </p>

      <p>
        Consider the <m>\mathrm{Binomial}(n,p)</m> distribution. Another situation where the Normal approximation may fail is when <m>p</m>, the probability of <q>Success</q> in the Binomial distribution, is too close to 0 (or too close to 1). Recall, that for large <m>n</m> the Poisson distribution emerged as an approximation of the Binomial distribution in such a setting. One may expect that when <m>n</m> is large and <m>p</m> is small then the Poisson distribution may produce a better approximation of a Binomial probability. When the Poisson distribution is used for the approximation we call it a <em>Poisson Approximation</em>.
      </p>

      <p>
        Let us consider an example. Let us analyze 3 Binomial distributions. The expectation in all the distributions is equal to 2 but the number of trials, <m>n</m>, vary. In the first case <m>n=20</m> (and hence <m>p=0.1</m>), in the second <m>n=200</m> (and <m>p=0.01</m>), and in the third <m>n=2,000</m> (and <m>p=0.001</m>). In all three cases we will be interested in the probability of obtaining a value less or equal to 3.
      </p>

      <p>
        The Poisson approximation replaces computations conducted under the Binomial distribution with Poisson computations, with a Poisson distribution that has the same expectation as the Binomial. Since in all three cases the expectation is equal to 2 we get that the same Poisson approximation is used to the three probabilities:
      </p>

      <program language="r">
        <input>
ppois(3,2)
        </input>
      </program>

      <p>
        The actual Binomial probability in the first case (<m>n=20</m>, <m>p=0.1</m>) and a Normal approximation thereof are:
      </p>

      <program language="r">
        <input>
pbinom(3,20,0.1)
pnorm(3.5,2,sqrt(20*0.1*0.9))
        </input>
      </program>

      <p>
        Observe that the Normal approximation (with a continuity correction) is better than the Poisson approximation in this case.
      </p>

      <p>
        In the second case (<m>n=200</m>, <m>p=0.01</m>) the actual Binomial probability and the Normal approximation of the probability are:
      </p>

      <program language="r">
        <input>
pbinom(3,200,0.01)
pnorm(3.5,2,sqrt(200*0.01*0.99))
        </input>
      </program>

      <p>
        Observe that the Poisson approximation that produces 0.8571235 is slightly closer to the target than the Normal approximation. The greater accuracy of the Poisson approximation for the case where <m>n</m> is large and <m>p</m> is small is more pronounced in the final case (<m>n=2000</m>, <m>p=0.001</m>) where the target probability and the Normal approximation are:
      </p>

      <program language="r">
        <input>
pbinom(3,2000,0.001)
pnorm(3.5,2,sqrt(2000*0.001*0.999))
        </input>
      </program>

      <p>
        Compare the actual Binomial probability, which is equal to 0.8572138, to the Poisson approximation that produced 0.8571235. The Normal approximation, 0.8556984, is slightly off, but is still acceptable.
      </p>
    </subsection>
  </section>

  <section xml:id="sec-exercises-6">
    <title>Exercises</title>
    
    <exercise xml:id="ex-lift-weight">
      <statement>
        <p>
          Consider the problem of establishing regulations concerning the maximum number of people who can occupy a lift. In particular, we would like to assess the probability of exceeding maximal weight when 8 people are allowed to use the lift simultaneously and compare that to the probability of allowing 9 people into the lift.
        </p>
        <p>
          Assume that the total weight of 8 people chosen at random follows a normal distribution with a mean of 560kg and a standard deviation of 57kg. Assume that the total weight of 9 people chosen at random follows a normal distribution with a mean of 630kg and a standard deviation of 61kg.
        </p>
        <p>
          <ol>
            <li><p>What is the probability that the total weight of 8 people exceeds 650kg?</p></li>
            <li><p>What is the probability that the total weight of 9 people exceeds 650kg?</p></li>
            <li><p>What is the central region that contains 80% of distribution of the total weight of 8 people?</p></li>
            <li><p>What is the central region that contains 80% of distribution of the total weight of 9 people?</p></li>
          </ol>
        </p>
      </statement>
    </exercise>

    <exercise xml:id="ex-binomial-approximations">
      <statement>
        <p>
          Assume <m>X \sim \mathrm{Binomial}(27,0.32)</m>. We are interested in the probability <m>P(X > 11)</m>.
        </p>
        <p>
          <ol>
            <li><p>Compute the (exact) value of this probability.</p></li>
            <li><p>Compute a Normal approximation to this probability, without a continuity correction.</p></li>
            <li><p>Compute a Normal approximation to this probability, with a continuity correction.</p></li>
            <li><p>Compute a Poisson approximation to this probability.</p></li>
          </ol>
        </p>
      </statement>
    </exercise>
  </section>

  <section xml:id="sec-summary-6">
    <title>Summary</title>

    <subsection xml:id="subsec-glossary-6">
      <title>Glossary</title>
      <dl>
        <li>
          <title>Normal Random Variable</title>
          <p>A bell-shaped distribution that is frequently used to model a measurement. The distribution is marked with <m>\mathrm{Normal}(\mu,\sigma^2)</m>.</p>
        </li>
        <li>
          <title>Standard Normal Distribution</title>
          <p>The <m>\mathrm{Normal}(0,1)</m>. The distribution of standardized Normal measurement.</p>
        </li>
        <li>
          <title>Percentile</title>
          <p>Given a percent <m>p \cdot 100\%</m> (or a probability <m>p</m>), the value <m>x</m> is the percentile of a random variable <m>X</m> if it satisfies the equation <m>P(X \leq x) = p</m>.</p>
        </li>
        <li>
          <title>Normal Approximation of the Binomial</title>
          <p>Approximate computations associated with the Binomial distribution with parallel computations that use the Normal distribution with the same expectation and standard deviation as the Binomial.</p>
        </li>
        <li>
          <title>Poisson Approximation of the Binomial</title>
          <p>Approximate computations associated with the Binomial distribution with parallel computations that use the Poisson distribution with the same expectation as the Binomial.</p>
        </li>
      </dl>
    </subsection>

    <subsection xml:id="subsec-discuss-in-forum-6">
      <title>Discuss in the Forum</title>
      <p>
        Mathematical models are used as tools to describe reality. These models are supposed to characterize the important features of the analyzed phenomena and provide insight. Random variables are mathematical models of measurements. Some people claim that there should be a perfect match between the mathematical characteristics of a random variable and the properties of the measurement it models. Other claim that a partial match is sufficient. What is your opinion?
      </p>
      <p>
        When forming your answer to this question you may give an example of a situation from you own field of interest for which a random variable can serve as a model. Identify discrepancies between the theoretical model and actual properties of the measurement. Discuss the appropriateness of using the model in light of these discrepancies.
      </p>
      <p>
        Consider, for example, testing IQ. The score of many IQ tests are modeled as having a Normal distribution with an expectation of 100 and a standard deviation of 15. The sample space of the Normal distribution is the entire line of real numbers, including the negative numbers. In reality, IQ tests produce only positive values.
      </p>
    </subsection>
  </section>
</chapter>
